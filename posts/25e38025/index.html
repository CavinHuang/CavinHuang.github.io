<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="baidu-site-verification" content="rqskM4bdtP"><meta name="viewport" content="device-width, initial-scale=1, maximum-scale=1,user-scalable=no"><title>linux操作记录(持续记录)-CavinHuangのBlog-http://blog.zukmb.cn</title><meta name="keywords" content="前端学习,php学习,个人博客,HTML,CSS,JS"><meta name="description" content="cavinHuang个人博客，这里记录学习和生活的点滴！"><meta name="google-site-verification" content="zOYxWUgmeogC0qY76WLP0eWl8r9E8jk_qU927Ij7tbs"><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a4c3745fa28006f"></script><link rel="stylesheet" href="/css/yoyo.css"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.3"><script src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script><script src="https://cdn.bootcss.com/velocity/1.5.0/velocity.min.js"></script><meta name="generator" content="Hexo 5.3.0"><link rel="stylesheet" href="/css/prism-base16-ateliersulphurpool.light.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body></body></html><div class="app"><div class="left-container"><div class="left-layout-container pc"><div class="user-info"><a href="/"><img src="https://avatars1.githubusercontent.com/u/24950299?s=460&amp;v=4"></a><div class="login-name">CavinHuang</div><div class="slog">来不及总结自己,愿天大地大,我独一无二!</div></div><ul class="other-site"><li><img src="http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/github.png"></li><li><img src="http://www.17sucai.com/preview/177065/2017-09-28/Mon9/static/img/weibo.png"></li></ul><ul class="left-menu"><li><a href="/archives">文章</a></li><li><a href="/categories">分类</a></li><li><a href="/tags">标签</a></li><li><a href="/about">关于</a></li></ul><div class="qq-group"><span>读万卷书</span><span>行万里路</span></div><div class="copyright">@ 2017 - 2017 CavinHuang</div></div></div><div id="app-aside"><aside class="aside"><div class="aside-user"><div class="avatar"><img src="https://avatars1.githubusercontent.com/u/24950299?s=460&amp;v=4" alt="CavinHuang"></div><div class="profile"><h3 class="name">CavinHuang</h3><p class="email">来不及总结自己,愿天大地大,我独一无二!</p></div></div><div class="aside-nav"><nav class="nav-list"><a class="item" href="/archives"><span>文章</span></a><a class="item" href="/categories"><span>分类</span></a><a class="item" href="/tags"><span>标签</span></a><a class="item" href="/about"><span>关于</span></a></nav></div></aside></div><div class="blog-container main-container" id="content-outer"><nav class="navbar"><div class="navbar-container"><div class="navbar-header"><a class="navbar-menu" id="navMenu" href="javascript:;" data-isOpen="false"><i class="iconfont icon-menu"></i></a><a class="navbar-logo" href="/"><img src="/assets/img/logo.png"></a><a class="navbar-search" href=""></a></div></div></nav><div class="blog-list-container" id="content-inner"><article class="article-container" id="post"><div class="article-header"><h1 class="article-title">linux操作记录(持续记录)</h1><div class="article-subtitle"><div class="publish-time fl">发布时间:<span>2018/12/13 11:54:19</span></div><div class="categories">分类:<a href="/categories/server/"><span>服务器操作</span></a>/<a href="/categories/server/bash/"><span>日常命令</span></a></div></div></div><div class="article-word-count"><ul><div class="word-count-item">全文约<span class="post-count">551</span>字</div><div class="word-count-item">预计需要<span class="post-count">2</span>分钟</div></ul></div><div class="article-content"><h2 id="重启php-fpm"><a href="#重启php-fpm" class="headerlink" title="重启php-fpm"></a>重启php-fpm</h2><h3 id="查看php-fpm的master进程号"><a href="#查看php-fpm的master进程号" class="headerlink" title="查看php-fpm的master进程号"></a>查看php-fpm的master进程号</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ps aux|grep php-fpm</span>
root     21891  0.0  0.0 112660   960 pts/3    R+   16:18   0:00 <span class="token function">grep</span> --color<span class="token operator">=</span>auto php-fpm
root     42891  0.0  0.1 182796  1220 ?        Ss   4月18   0:19 php-fpm: master process <span class="token punctuation">(</span>/Data/apps/php7/etc/php-fpm.conf<span class="token punctuation">)</span>
nobody   42892  0.0  0.6 183000  6516 ?        S    4月18   0:07 php-fpm: pool www
nobody   42893  0.0  0.6 183000  6508 ?        S    4月18   0:17 php-fpm: pool www<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="重启php-fpm-1"><a href="#重启php-fpm-1" class="headerlink" title="重启php-fpm:"></a>重启php-fpm:</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">kill</span> -USR2 42891<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><a id="more"></a><h2 id="redis操作"><a href="#redis操作" class="headerlink" title="redis操作"></a>redis操作</h2><h3 id="检测是否有安装redis-cli和redis-server"><a href="#检测是否有安装redis-cli和redis-server" class="headerlink" title="检测是否有安装redis-cli和redis-server"></a>检测是否有安装redis-cli和redis-server</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localhost bin<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># whereis redis-cli</span>
redis-cli: /usr/bin/redis-cli

<span class="token punctuation">[</span>root@localhost bin<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># whereis redis-server</span>
redis-server: /usr/bin/redis-server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="检测后台进程是否存在"><a href="#检测后台进程是否存在" class="headerlink" title="检测后台进程是否存在"></a>检测后台进程是否存在</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">ps</span> -ef <span class="token operator">|</span><span class="token function">grep</span> redis<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="检测redis端口"><a href="#检测redis端口" class="headerlink" title="检测redis端口"></a>检测redis端口</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">netstat</span> -lntp <span class="token operator">|</span> <span class="token function">grep</span> 6379<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="使用redis-cli客户端检测连接是否正常"><a href="#使用redis-cli客户端检测连接是否正常" class="headerlink" title="使用redis-cli客户端检测连接是否正常"></a>使用redis-cli客户端检测连接是否正常</h3><pre class="line-numbers language-bash"><code class="language-bash">redis-cli
127.0.0.1:6379<span class="token operator">></span> keys *
<span class="token punctuation">(</span>empty list or set<span class="token punctuation">)</span>
127.0.0.1:6379<span class="token operator">></span> <span class="token keyword">set</span> key <span class="token string">"hello world"</span>
OK
127.0.0.1:6379<span class="token operator">></span> get key
<span class="token string">"hello world"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="停止redis"><a href="#停止redis" class="headerlink" title="停止redis"></a>停止redis</h3><h4 id="使用客户端"><a href="#使用客户端" class="headerlink" title="使用客户端"></a>使用客户端</h4><pre class="line-numbers language-bash"><code class="language-bash">redis-cli <span class="token function">shutdown</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="因为Redis可以妥善处理SIGTERM信号，所以直接kill-9也是可以的"><a href="#因为Redis可以妥善处理SIGTERM信号，所以直接kill-9也是可以的" class="headerlink" title="因为Redis可以妥善处理SIGTERM信号，所以直接kill -9也是可以的"></a>因为Redis可以妥善处理SIGTERM信号，所以直接kill -9也是可以的</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">kill</span> -9 PID<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="iptables简单配置方法"><a href="#iptables简单配置方法" class="headerlink" title="iptables简单配置方法"></a>iptables简单配置方法</h2><h3 id="修改方式一-直接修改配置文件"><a href="#修改方式一-直接修改配置文件" class="headerlink" title="修改方式一: 直接修改配置文件"></a>修改方式一: 直接修改配置文件</h3><pre class="line-numbers language-bash"><code class="language-bash">vim /etc/sysconfig/iptables<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="修改方式二：通过iptables命令添加"><a href="#修改方式二：通过iptables命令添加" class="headerlink" title="修改方式二：通过iptables命令添加"></a>修改方式二：通过iptables命令添加</h3><pre class="line-numbers language-bash"><code class="language-bash">iptables -A INPUT -p tcp --dport 8080 -j ACCEPT<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="重启iptables"><a href="#重启iptables" class="headerlink" title="重启iptables"></a>重启iptables</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">service</span> iptables restart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="配置文件解释"><a href="#配置文件解释" class="headerlink" title="配置文件解释"></a>配置文件解释</h3><pre class="line-numbers language-bash"><code class="language-bash">*filter
<span class="token comment" spellcheck="true">#默认INPUT 的策略是DROP 即拒绝所有的外来请求</span>
:INPUT DROP <span class="token punctuation">[</span>0:0<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true">#一般情况下用不到FORWARD 可以配置为默认DROP</span>
:FORWARD DROP <span class="token punctuation">[</span>0:0<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true">#本机对其他机器访问设置为默认ACCEPT</span>
:OUTPUT ACCEPT <span class="token punctuation">[</span>0:0<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true">#允许已经建立和相关的连接</span>
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
<span class="token comment" spellcheck="true">#允许icmp协议(即ping)</span>
-A INPUT -p icmp -j ACCEPT
<span class="token comment" spellcheck="true">#允许回环请求</span>
-A INPUT -i lo -j ACCEPT
<span class="token comment" spellcheck="true">#开放端口22 80(如果要开放其他端口 继续添加开放规则即可)</span>
-A INPUT -p tcp -m state --state NEW -m tcp --dport 22 -j ACCEPT
-A INPUT -p tcp -m state --state NEW -m tcp --dport 80 -j ACCEPT
COMMIT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="chmod-更改’authorized-keys’-的权限-不允许的操作"><a href="#chmod-更改’authorized-keys’-的权限-不允许的操作" class="headerlink" title="chmod: 更改’authorized_keys’ 的权限: 不允许的操作"></a>chmod: 更改’authorized_keys’ 的权限: 不允许的操作</h3><p>原因<br>在linux系统下</p><p>有些配置文件是不允许被任何人（包括root）修改的<br>为了防止被误修改或删除<br>可以设定该文件的不可修改位：immutable</p><p>解决办法 ：chattr<br>防止关键文件被修改：<br>　　chattr +i authorized_keys<br>如果需要修改文件则：<br>　　chattr -i authorized_keys</p></div><div id="side-right-bar"><div class="close-right-bar"></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%90%AFphp-fpm"><span class="toc-number">1.</span> <span class="toc-text">重启php-fpm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bphp-fpm%E7%9A%84master%E8%BF%9B%E7%A8%8B%E5%8F%B7"><span class="toc-number">1.1.</span> <span class="toc-text">查看php-fpm的master进程号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%90%AFphp-fpm-1"><span class="toc-number">1.2.</span> <span class="toc-text">重启php-fpm:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E6%93%8D%E4%BD%9C"><span class="toc-number">2.</span> <span class="toc-text">redis操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E6%9C%89%E5%AE%89%E8%A3%85redis-cli%E5%92%8Credis-server"><span class="toc-number">2.1.</span> <span class="toc-text">检测是否有安装redis-cli和redis-server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%E5%90%8E%E5%8F%B0%E8%BF%9B%E7%A8%8B%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="toc-number">2.2.</span> <span class="toc-text">检测后台进程是否存在</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%B5%8Bredis%E7%AB%AF%E5%8F%A3"><span class="toc-number">2.3.</span> <span class="toc-text">检测redis端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8redis-cli%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A3%80%E6%B5%8B%E8%BF%9E%E6%8E%A5%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8"><span class="toc-number">2.4.</span> <span class="toc-text">使用redis-cli客户端检测连接是否正常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2redis"><span class="toc-number">2.5.</span> <span class="toc-text">停止redis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">2.5.1.</span> <span class="toc-text">使用客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%A0%E4%B8%BARedis%E5%8F%AF%E4%BB%A5%E5%A6%A5%E5%96%84%E5%A4%84%E7%90%86SIGTERM%E4%BF%A1%E5%8F%B7%EF%BC%8C%E6%89%80%E4%BB%A5%E7%9B%B4%E6%8E%A5kill-9%E4%B9%9F%E6%98%AF%E5%8F%AF%E4%BB%A5%E7%9A%84"><span class="toc-number">2.5.2.</span> <span class="toc-text">因为Redis可以妥善处理SIGTERM信号，所以直接kill -9也是可以的</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iptables%E7%AE%80%E5%8D%95%E9%85%8D%E7%BD%AE%E6%96%B9%E6%B3%95"><span class="toc-number">3.</span> <span class="toc-text">iptables简单配置方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%B9%E5%BC%8F%E4%B8%80-%E7%9B%B4%E6%8E%A5%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">修改方式一: 直接修改配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%B9%E5%BC%8F%E4%BA%8C%EF%BC%9A%E9%80%9A%E8%BF%87iptables%E5%91%BD%E4%BB%A4%E6%B7%BB%E5%8A%A0"><span class="toc-number">3.2.</span> <span class="toc-text">修改方式二：通过iptables命令添加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%90%AFiptables"><span class="toc-number">3.3.</span> <span class="toc-text">重启iptables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A7%A3%E9%87%8A"><span class="toc-number">3.4.</span> <span class="toc-text">配置文件解释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chmod-%E6%9B%B4%E6%94%B9%E2%80%99authorized-keys%E2%80%99-%E7%9A%84%E6%9D%83%E9%99%90-%E4%B8%8D%E5%85%81%E8%AE%B8%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">3.5.</span> <span class="toc-text">chmod: 更改’authorized_keys’ 的权限: 不允许的操作</span></a></li></ol></li></ol></div></div></div><div class="right-btn" id="right-btn"><span>目录</span></div><div class="article-bottom"><div class="addthis_inline_share_toolbox fr"></div></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者:</span><span class="post-copyright-info"><a href="mailto:undefined">CavinHuang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接:</span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="http://blog.zukmb.cnposts/25e38025/">http://blog.zukmb.cn/posts/25e38025/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明:</span><span class="post-copyright-info">转载请注明来自<a href="http://blog.zukmb.cn" target="_blank" style="font-size: 18px;">CavinHuangのBlog</a>！</span></div></div><div class="article-pagenate"><div class="article-prev fl"><span>←</span><a href="/posts/908ebc90/">php知识梳理系列-数组(-)</a></div><div class="article-next fr"><a href="/posts/6b730681/">canvas文字粒子特效(含运动)</a><span>→</span></div></div></article></div><footer class="footer"><div id="toTop" style="display: none;">Back to Top</div><div class="footer-content"><p>©2015 - 2018 By cavinHuang</p><div class="framework-info"><span>Driven -</span> <a target="_blank" rel="noopener" href="https://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme -</span> <a href=""><span>yoyo</span></a></div><div class="site-count"><ul><div class="site-count-item"><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></div><div class="site-count-item"><span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人次</span></div></ul></div></div></footer><script>(function(){
var bp = document.createElement('script');
var curProtocol = window.location.protocol.split(':')[0];
if (curProtocol === 'https') {
bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
}
else {
bp.src = 'http://push.zhanzhang.baidu.com/push.js';
}
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(bp, s);
})();
</script><script>(function(){
var src = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?e055b4dda1d8e03e86cb32d91596a2c5":"https://jspassport.ssl.qhimg.com/11.0.1.js?e055b4dda1d8e03e86cb32d91596a2c5";
document.write('<script src="' + src + '" id="sozz"><\\/script>');
})();
</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-124916034-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-124916034-1');</script></div></div><canvas class="fireworks"></canvas><script src="/js/velocity.ui.min.js"></script><script src="/js/yoyo.js"></script><script src="/js/scroll.js"></script><script src="/js/anime.min.js"></script><script src="/js/fireworks.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>